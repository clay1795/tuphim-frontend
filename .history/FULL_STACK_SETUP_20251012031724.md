# 🚀 Hướng dẫn Share Full-Stack TupPhim (Frontend + Backend)

## 🎯 Mục tiêu: Share cả Frontend và Backend hoạt động đầy đủ

### **Kết quả mong đợi:**
- ✅ **Frontend URL** - Người dùng truy cập ứng dụng
- ✅ **Backend URL** - API hoạt động đầy đủ
- ✅ **Kết nối đầy đủ** - Frontend gọi API từ Backend URL

## 🚀 Cách thực hiện:

### **Bước 1: Chạy script share full-stack**
```bash
share-full-stack.bat
```

### **Bước 2: Lấy 2 Public URLs**
Sau khi chạy script, bạn sẽ có:
- **Frontend URL:** `https://abc123.ngrok.io` (port 5173)
- **Backend URL:** `https://def456.ngrok.io` (port 3001)

### **Bước 3: Cấu hình Frontend sử dụng Backend URL**

#### **Option A: Sửa trực tiếp trong code**

1. **Mở file:** `src/services/movieApi.js`
2. **Tìm dòng:** `baseURL: 'http://localhost:3001'`
3. **Thay thành:** `baseURL: 'https://def456.ngrok.io'` (Backend URL)

#### **Option B: Sử dụng Environment Variable**

1. **Tạo file:** `.env.local`
2. **Thêm dòng:**
   ```
   VITE_API_URL=https://def456.ngrok.io
   ```
3. **Cập nhật movieApi.js:**
   ```javascript
   baseURL: import.meta.env.VITE_API_URL || 'http://localhost:3001'
   ```

#### **Option C: Dynamic API URL (Khuyến nghị)**

1. **Mở file:** `src/services/movieApi.js`
2. **Thay đổi baseURL:**
   ```javascript
   const getApiUrl = () => {
     // Nếu đang chạy trên ngrok domain
     if (window.location.hostname.includes('ngrok.io') || 
         window.location.hostname.includes('ngrok-free.dev')) {
       // Sử dụng Backend URL (thay def456 bằng URL thực tế)
       return 'https://def456.ngrok.io';
     }
     // Nếu chạy local
     return 'http://localhost:3001';
   };
   
   const api = axios.create({
     baseURL: getApiUrl(),
     // ... rest of config
   });
   ```

### **Bước 4: Restart Frontend**
```bash
# Dừng frontend hiện tại (Ctrl+C)
# Chạy lại
npm run dev
```

### **Bước 5: Test Full-Stack**

1. **Mở Frontend URL** trên điện thoại: `https://abc123.ngrok.io`
2. **Kiểm tra các tính năng:**
   - ✅ Đăng nhập/Đăng ký
   - ✅ Tìm kiếm phim
   - ✅ Xem chi tiết phim
   - ✅ User profile
   - ✅ Favorites
   - ✅ Watch history

## 🔧 Troubleshooting

### **Lỗi CORS:**
- ✅ **Đã sửa** - Backend đã cấu hình chấp nhận ngrok domains
- ✅ **Restart backend** nếu cần: `cd backend && npm start`

### **API không hoạt động:**
- ✅ **Kiểm tra Backend URL** - Đảm bảo đúng URL
- ✅ **Kiểm tra network** - Mở DevTools trên điện thoại
- ✅ **Test API trực tiếp** - Mở Backend URL trong trình duyệt

### **Frontend không load:**
- ✅ **Kiểm tra Frontend URL** - Đảm bảo đúng URL
- ✅ **Clear cache** - Refresh trang hoặc mở tab ẩn danh
- ✅ **Kiểm tra console** - Xem lỗi JavaScript

## 📱 Test trên điện thoại

### **Android/iPhone:**
1. **Mở trình duyệt** (Chrome, Safari)
2. **Nhập Frontend URL:** `https://abc123.ngrok.io`
3. **Kiểm tra tính năng:**
   - Đăng nhập/Đăng ký
   - Tìm kiếm phim
   - Xem chi tiết phim
   - User profile

### **Kiểm tra Network:**
1. **Mở DevTools** (Chrome: F12)
2. **Tab Network** - Xem API calls
3. **Đảm bảo** API calls đến Backend URL

## 🎯 Cấu hình nâng cao

### **Environment Variables:**
```bash
# .env.local
VITE_API_URL=https://def456.ngrok.io
VITE_APP_NAME=TupPhim
VITE_APP_VERSION=1.0.0
```

### **Dynamic Configuration:**
```javascript
// src/config/api.js
export const API_CONFIG = {
  baseURL: window.location.hostname.includes('ngrok') 
    ? 'https://def456.ngrok.io' 
    : 'http://localhost:3001',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json'
  }
};
```

## 🎉 Kết quả cuối cùng

Sau khi setup xong:
- ✅ **Frontend URL** - Người dùng truy cập ứng dụng
- ✅ **Backend URL** - API hoạt động đầy đủ
- ✅ **Kết nối đầy đủ** - Tất cả tính năng hoạt động
- ✅ **Share với bạn bè** - Họ có thể sử dụng đầy đủ

## 💡 Tips

1. **Bookmark URLs** - Lưu lại để sử dụng sau
2. **Monitor ngrok dashboard** - http://localhost:4040
3. **Test thường xuyên** - Đảm bảo cả hai URLs hoạt động
4. **Backup configuration** - Lưu lại cấu hình API

**🎯 Bây giờ bạn có thể share TupPhim full-stack với bạn bè!** 🚀
