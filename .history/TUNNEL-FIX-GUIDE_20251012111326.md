# ğŸ”§ HÆ°á»›ng Dáº«n Kháº¯c Phá»¥c Tunnel API Connection

## âœ… Váº¥n Ä‘á» Ä‘Ã£ Ä‘Æ°á»£c giáº£i quyáº¿t!

**Váº¥n Ä‘á»**: Frontend Ä‘ang cá»‘ gáº¯ng gá»i API Ä‘áº¿n `http://localhost:3001` thay vÃ¬ sá»­ dá»¥ng tunnel URL, gÃ¢y ra CORS errors vÃ  khÃ´ng hiá»ƒn thá»‹ phim.

**Giáº£i phÃ¡p**: Cáº¥u hÃ¬nh API URL Ä‘á»™ng Ä‘á»ƒ tá»± Ä‘á»™ng detect tunnel environment.

## ğŸ¯ Nhá»¯ng gÃ¬ Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t:

### 1. **API Configuration Dynamic** (`src/config/apiConfig.js`)
- Tá»± Ä‘á»™ng detect tunnel environment
- Sá»­ dá»¥ng tunnel URL khi cháº¡y qua VS Code Port Forwarding
- Fallback vá» localhost khi cháº¡y local

### 2. **Updated Files**:
- âœ… `src/App.jsx` - API calls cho homepage movies
- âœ… `src/context/AuthContextSimple.jsx` - User authentication APIs
- âœ… `src/services/simpleMovieApi.js` - Movie API services
- âœ… `src/services/mongoMovieApi.js` - MongoDB API services
- âœ… `src/services/instantSearchApi.js` - Search API services
- âœ… `src/services/movieApi.js` - Main movie API services
- âœ… `src/components/Banner.jsx` - Featured movies
- âœ… `src/components/MovieDetailTest.jsx` - Movie detail testing

## ğŸš€ CÃ¡ch sá»­ dá»¥ng:

### **BÆ°á»›c 1: Restart Frontend Server**
```bash
# Dá»«ng frontend server hiá»‡n táº¡i (Ctrl+C)
# Cháº¡y láº¡i vá»›i cáº¥u hÃ¬nh má»›i
npm run dev:host
```

### **BÆ°á»›c 2: Kiá»ƒm tra Console**
Má»Ÿ browser DevTools Console, báº¡n sáº½ tháº¥y:
```
ğŸ”§ API Configuration: {
  baseUrl: "https://33ss6xpk-3001.asse.devtunnels.ms/api",
  isTunnel: true,
  tunnelBackendUrl: "https://33ss6xpk-3001.asse.devtunnels.ms",
  currentOrigin: "https://33ss6xpk-5173.asse.devtunnels.ms"
}
```

### **BÆ°á»›c 3: Test API Connection**
```bash
# Cháº¡y test script
node test-api-connection.cjs
```

## ğŸ‰ Káº¿t quáº£ mong Ä‘á»£i:

### âœ… **Phim sáº½ hiá»ƒn thá»‹ Ä‘áº§y Ä‘á»§**:
- âœ… "Phim Ä‘á» xuáº¥t chÃ­nh" section
- âœ… "Top6 phim" section  
- âœ… Featured movies trong banner
- âœ… Suggested movies
- âœ… Táº¥t cáº£ movie sections

### âœ… **KhÃ´ng áº£nh hÆ°á»Ÿng localhost**:
- âœ… Localhost váº«n hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng
- âœ… Cáº¥u hÃ¬nh tá»± Ä‘á»™ng detect environment
- âœ… KhÃ´ng cáº§n thay Ä‘á»•i code khi switch giá»¯a localhost vÃ  tunnel

### âœ… **Mobile access hoáº¡t Ä‘á»™ng**:
- âœ… Truy cáº­p tá»« mobile: `https://33ss6xpk-5173.asse.devtunnels.ms/`
- âœ… Táº¥t cáº£ tÃ­nh nÄƒng hoáº¡t Ä‘á»™ng Ä‘áº§y Ä‘á»§
- âœ… Database MongoDB káº¿t ná»‘i bÃ¬nh thÆ°á»ng

## ğŸ” Debugging:

### **Náº¿u váº«n cÃ³ váº¥n Ä‘á»**:

1. **Kiá»ƒm tra Console Logs**:
   - Má»Ÿ DevTools Console
   - TÃ¬m message "ğŸ”§ API Configuration"
   - Äáº£m báº£o `isTunnel: true` vÃ  `baseUrl` cÃ³ tunnel domain

2. **Kiá»ƒm tra Network Tab**:
   - Má»Ÿ DevTools Network tab
   - TÃ¬m API calls Ä‘áº¿n `/api/movies/new` hoáº·c `/api/mongo-movies/new`
   - Äáº£m báº£o URLs cÃ³ tunnel domain, khÃ´ng pháº£i localhost

3. **Test API trá»±c tiáº¿p**:
   ```bash
   # Test backend tunnel URL
   curl https://33ss6xpk-3001.asse.devtunnels.ms/api/health
   
   # Test movies API
   curl https://33ss6xpk-3001.asse.devtunnels.ms/api/mongo-movies/new?page=1&limit=24
   ```

## ğŸ“± URLs hiá»‡n táº¡i:
- **Frontend**: https://33ss6xpk-5173.asse.devtunnels.ms/
- **Backend**: https://33ss6xpk-3001.asse.devtunnels.ms/

## ğŸ¯ TÃ­nh nÄƒng Ä‘Ã£ hoáº¡t Ä‘á»™ng:
- âœ… **Homepage movies** - Phim má»›i cáº­p nháº­t
- âœ… **Featured movies** - Phim ná»•i báº­t trong banner
- âœ… **Suggested movies** - Phim Ä‘á» xuáº¥t
- âœ… **Search functionality** - TÃ¬m kiáº¿m phim
- âœ… **User authentication** - ÄÄƒng kÃ½/Ä‘Äƒng nháº­p
- âœ… **Favorites & History** - YÃªu thÃ­ch vÃ  lá»‹ch sá»­
- âœ… **Movie details** - Chi tiáº¿t phim
- âœ… **MongoDB integration** - Káº¿t ná»‘i database

BÃ¢y giá» website sáº½ hiá»ƒn thá»‹ Ä‘áº§y Ä‘á»§ phim tá»« MongoDB vÃ  hoáº¡t Ä‘á»™ng hoÃ n háº£o trÃªn cáº£ PC vÃ  mobile! ğŸš€ğŸ“±
